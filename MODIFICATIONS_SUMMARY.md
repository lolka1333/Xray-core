# üöÄ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ Xray –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI - –í–´–ü–û–õ–ù–ï–ù–û

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥

### 1. **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤ VLESS** 
üìÑ **–§–∞–π–ª:** `/workspace/Xray-core/proxy/vless/encoding/encoding.go`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –Ω–∞ 3 —á–∞—Å—Ç–∏
- –ü–∞–∫–µ—Ç—ã –±–æ–ª—å—à–µ 50 –±–∞–π—Ç —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
- –ö–∞–∂–¥—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

```go
// DPI Evasion: Fragment first packet into smaller pieces
if len(data) > 50 {
    fragmentSize := len(data) / 3
    for i := 0; i < len(data); i += fragmentSize {
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –ø–æ —á–∞—Å—Ç—è–º
    }
}
```

### 2. **–û–±–µ—Ä—Ç–∫–∞ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π**
üìÑ **–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `/workspace/Xray-core/transport/internet/tcp/fragmented_writer.go`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–µ—Ä–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ 10-50ms –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- –ú–∏–∫—Ä–æ–∑–∞–¥–µ—Ä–∂–∫–∏ 1-5ms –º–µ–∂–¥—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏
- –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ 2-4 —á–∞—Å—Ç–∏

### 3. **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è TCP Dialer**
üìÑ **–§–∞–π–ª:** `/workspace/Xray-core/transport/internet/tcp/dialer.go`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í—Å–µ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ FragmentedConn
- –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è API

```go
// DPI Evasion: Wrap connection with fragmentation support
if streamSettings.SocketSettings != nil {
    conn = NewFragmentedConn(conn)
}
```

### 4. **–†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è TLS –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
üìÑ **–§–∞–π–ª:** `/workspace/Xray-core/transport/internet/tls/config.go`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- **–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ ALPN –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤** - –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏
- **–†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è Cipher Suites** - –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —à–∏—Ñ—Ä–æ–≤
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –∫–∞–∂–¥–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ

```go
// –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è ALPN
for i := len(nextProtos) - 1; i > 0; i-- {
    j := mrand.Intn(i + 1)
    nextProtos[i], nextProtos[j] = nextProtos[j], nextProtos[i]
}

// –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è Cipher Suites
for i := len(config.CipherSuites) - 1; i > 0; i-- {
    j := mrand.Intn(i + 1)
    config.CipherSuites[i], config.CipherSuites[j] = ...
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π

### –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è:
- **–§–∞–π–ª:** `/workspace/xray_dpi_patched`
- **–†–∞–∑–º–µ—Ä:** 29MB
- **–í–µ—Ä—Å–∏—è:** Xray 25.9.5 (DPI-Patched-v1.0)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** linux/amd64

### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:

1. **–†–∞–∑—Ä—É—à–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä –ø—Ä–æ—Ç–æ–∫–æ–ª–∞**
   - DPI –Ω–µ –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ –ø–µ—Ä–≤—ã–º –ø–∞–∫–µ—Ç–∞–º
   - –†–∞–∑–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏

2. **–û–±—Ö–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞**
   - –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ª–æ–º–∞—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ —Ç–∞–π–º–∏–Ω–≥–∞–º

3. **–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ TLS**
   - –ö–∞–∂–¥–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—ã–≥–ª—è–¥–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ
   - –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Xray
   - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–º–µ–Ω–∏—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ Xray:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π Xray
sudo systemctl stop xray

# –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
sudo cp /usr/local/bin/xray /usr/local/bin/xray.original

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
sudo cp /workspace/xray_dpi_patched /usr/local/bin/xray
sudo chmod +x /usr/local/bin/xray

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Xray
sudo systemctl start xray
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```json
{
  "streamSettings": {
    "sockopt": {
      "tcpFastOpen": true,
      "tcpNoDelay": true,
      "mark": 255
    },
    "tlsSettings": {
      "fingerprint": "chrome",
      "serverName": "www.microsoft.com"
    }
  }
}
```

### 3. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç—ã: 8443, 2053, 2083
- –í–∫–ª—é—á–∏—Ç–µ mux –¥–ª—è —Å–º–µ—à–∏–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Reality –∏–ª–∏ VLESS+Vision
- –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

## üéØ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π

–≠—Ç–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –ø—Ä–æ—Ç–∏–≤ DPI –≤ –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö:

1. **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑—Ä—É—à–∞–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—ã** –∫–æ—Ç–æ—Ä—ã–µ –∏—â–µ—Ç DPI
2. **–°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏** –Ω–µ –¥–∞—é—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ –≤—Ä–µ–º–µ–Ω–∏
3. **TLS —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è** –º–∞—Å–∫–∏—Ä—É–µ—Ç –ø–æ–¥ –æ–±—ã—á–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä
4. **–ú–∞–ª—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã** –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è MTU

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∑–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å (5-10%)
2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Xray/V2Ray
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Xray –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ –≤–µ—Ä—Å–∏–∏ 25.9.5

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 4
- **–î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~300
- **–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è, —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è, –∑–∞–¥–µ—Ä–∂–∫–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** 100% —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º Xray

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 05.09.2024  
**–ê–≤—Ç–æ—Ä –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π:** DPI Evasion Patch  
**–ë–∞–∑–∞:** Xray-core v25.9.5